!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):e.cep=r()}(this,function(){"use strict";function e(e,r){return r=r||{},new Promise(function(t,n){var o=new XMLHttpRequest,i=[],s=[],a={},c=function e(){return{ok:2==(o.status/100|0),statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(JSON.parse(o.responseText))},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:e,headers:{keys:function(){return i},entries:function(){return s},get:function(e){return a[e.toLowerCase()]},has:function(e){return e.toLowerCase()in a}}}};for(var u in o.open(r.method||"get",e,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(e,r,t){i.push(r=r.toLowerCase()),s.push([r,t]),a[r]=a[r]?a[r]+","+t:t}),t(c())},o.onerror=n,o.withCredentials="include"==r.credentials,r.headers)o.setRequestHeader(u,r.headers[u]);o.send(r.body||null)})}function r(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=r+"https://apps.correios.com.br/SigepMasterJPA/AtendeClienteService/AtendeCliente",o={method:"POST",body:'<?xml version="1.0"?>\n<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:cli="http://cliente.bean.master.sigep.bsb.correios.com.br/">\n  <soapenv:Header />\n  <soapenv:Body>\n    <cli:consultaCEP>\n      <cep>'+e+"</cep>\n    </cli:consultaCEP>\n  </soapenv:Body>\n</soapenv:Envelope>",headers:{"Content-Type":"text/xml;charset=UTF-8","cache-control":"no-cache"}};return H(n,o).then(t).catch(a)}function t(e){return e.ok?e.text().then(n).then(s):e.text().then(o).then(i)}function n(e){try{var r=e.replace(/\r?\n|\r/g,"").match(/<return>(.*)<\/return>/)[0]||"",t=r.replace("<return>","").replace("</return>",""),n=t.split(/</).reduce(function(e,r){var t=r.split(">");return t.length>1&&t[1].length&&(e[t[0]]=t[1]),e},{});return n}catch(e){throw new Error("Não foi possível interpretar o XML de resposta.")}}function o(e){try{var r=e.match(/<faultstring>(.*)<\/faultstring>/)[0]||"",t=r.replace("<faultstring>","").replace("</faultstring>","");return t}catch(e){throw new Error("Não foi possível interpretar o XML de resposta.")}}function i(e){throw new Error(e)}function s(e){return{cep:e.cep,state:e.uf,city:e.cidade,neighborhood:e.bairro,street:e.end}}function a(e){var r=new M({message:e.message,service:"correios"});throw"FetchError"===e.name&&(r.message="Erro ao se conectar com o serviço dos Correios."),r}function c(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=r+"https://viacep.com.br/ws/"+e+"/json/",n={method:"GET",mode:"cors",headers:{"content-type":"application/json;charset=utf-8"}};return H(t,n).then(u).then(p).then(f).catch(l)}function u(e){if(e.ok)return e.json();throw Error("Erro ao se conectar com o serviço ViaCEP.")}function p(e){if(e.erro===!0)throw new Error("CEP não encontrado na base do ViaCEP.");return e}function f(e){return{cep:e.cep.replace("-",""),state:e.uf,city:e.localidade,neighborhood:e.bairro,street:e.logradouro}}function l(e){var r=new M({message:e.message,service:"viacep"});throw"FetchError"===e.name&&(r.message="Erro ao se conectar com o serviço ViaCEP."),r}function h(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=r+"https://cep.widenet.host/busca-cep/api/cep/"+e+".json",n={method:"GET",mode:"cors",headers:{"content-type":"application/json;charset=utf-8"}};return H(t,n).then(d).then(m).then(v).catch(y)}function d(e){if(e.ok)return e.json();throw Error("Erro ao se conectar com o serviço WideNet.")}function m(e){if(e.ok===!1||200!==e.status)throw new Error("CEP não encontrado na base do WideNet.");return e}function v(e){return{cep:e.code.replace("-",""),state:e.state,city:e.city,neighborhood:e.district,street:e.address}}function y(e){var r=new M({message:e.message,service:"widenet"});throw"FetchError"===e.name&&(r.message="Erro ao se conectar com o serviço WideNet."),r}function g(){return"undefined"!=typeof window}function w(e){return function(r){return e(r,V)}}function b(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Promise.resolve(e).then(P).then(function(e){return E(r),e}).then(C).then(x).then(_).then(function(e){return j(e,r)}).catch(O).catch(S)}function E(e){var r=["correios","viacep","widenet"];if(!Array.isArray(e))throw new z({message:"Erro ao inicializar a instância do CepPromise.",type:"validation_error",errors:[{message:"O parâmetro providers deve ser uma lista.",service:"cep_validation"}]});return e.map(function(e){if(!r.includes(e))throw new z({message:"Erro ao inicializar a instância do CepPromise.",type:"validation_error",errors:[{message:'O provider "'+e+'" é inválido. Os providers disponíveis são: '+r.join(", ")+".",service:"cep_validation"}]});return e})}function P(e){var r="undefined"==typeof e?"undefined":T(e);if("number"===r||"string"===r)return e;throw new z({message:"Erro ao inicializar a instância do CepPromise.",type:"validation_error",errors:[{message:"Você deve chamar o construtor utilizando uma String ou um Number.",service:"cep_validation"}]})}function C(e){return e.toString().replace(/\D+/g,"")}function _(e){return"0".repeat(G-e.length)+e}function x(e){if(e.length<=G)return e;throw new z({message:"CEP deve conter exatamente "+G+" caracteres.",type:"validation_error",errors:[{message:"CEP informado possui mais do que "+G+" caracteres.",service:"cep_validation"}]})}function j(e,r){var t={correios:q,widenet:W,viacep:B};return 0===r.length?Promise.any(Object.keys(t).map(function(r){return t[r](e)})):Promise.any(r.map(function(r){return t[r](e)}))}function O(e){if(void 0!==e.length)throw new z({message:"Todos os serviços de CEP retornaram erro.",type:"service_error",errors:e});throw e}function S(e){var r=e.message,t=e.type,n=e.errors;throw new z({message:r,type:t,errors:n})}var T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},k=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},L=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r},N=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)},z=function(e){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.message,n=e.type,o=e.errors;A(this,r);var i=L(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return i.name="CepPromiseError",i.message=t,i.type=n,i.errors=o,i}return k(r,e),r}(Error),R=Object.freeze({default:e}),F=R&&e||R,H=window.fetch||(window.fetch=F.default||F),M=function(e){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.message,n=e.service;A(this,r);var o=L(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return o.name="ServiceError",o.message=t,o.service=n,o}return k(r,e),r}(Error),V="https://proxier.now.sh/api?url=",q=g()?w(r):r,B=c,W=h,X=function(e){return new Promise(function(r,t){return Promise.resolve(e).then(t,r)})};Promise.any=function(e){return X(Promise.all([].concat(N(e)).map(X)))};var G=8;return b});